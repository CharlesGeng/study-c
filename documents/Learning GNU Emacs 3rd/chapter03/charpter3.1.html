<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
lang="en" xml:lang="en">
<head>
<title>3.1. 不同的查询方式</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2010-12-20 23:02:59 CST"/>
<meta name="author" content="moomu"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">

<h1 class="title">3.1. 不同的查询方式</h1>

<p>在编辑的时候，经常会碰到查找已经输入的内容。几乎所有的编辑器都提供一些查找功能，让你查找指定的字符串，而不必翻阅整个文档。Emacs也
是一样。它提供一个查找指令，事实上，它可能提供令人眼花缭乱的查询指令。下面对各种可用的查询方式做一个汇总：
</p>
<p>
<i>简单查询</i> <br/>
告诉Emacs一个字符串，它就会查找下一个匹配项。这和其他编辑器别无二致。
</p>
<p>
<i>递增查询</i> <br/>
递增查询时，当你开始输入字符串的第一个字符时，Emacs就开始查询字符串。在你输入的时候会不停的查询。
</p>
<p>
<i>单词查询</i> <br/>
单词查询与简单查询类似，只不过是Emacs只查询整个单词或短语。例如，你要查找单词 <b>hat</b> ，你不必担心会查到 <b>that</b> 。单词
查找对于跨行的短语也比较有用。
</p>
<p>
<i>正则表达式查找</i> <br/>
模式查询，可以使用正则表达式查询。例如，如果你想查找所有的 <b>B1</b> 和 <b>B2</b> ，可以通过正则表达式 <b>B</b> <b>[</b> <b>12</b> <b>]</b> 查找。然
而，正则表达式相当复杂，我们会先给出一个简要的介绍，第11章会有更全面的介绍。
</p>
<p>
<i>递增正则表达式查询</i> <br/>
这个查询方式是 <i>递增查询</i> 和 <i>正则表达式查询</i> 的组合。
</p>
<p>
你可以向下查询，也可以向上。查询可以是大小写敏感的（例如， <i>This</i> 和 <i>this</i> 是不同的）或者大小写不敏感（例如， <i>This</i> 和 <i>this</i>
是相同的）。默认情况下，查询是不区分大小写的。不过，如果你输入了大写字母，那么这此查询就是大小写敏感的了，因为Emacs认为你既然费
力地准确输入字符就是为了准确查询。
</p>
<p>
替换操作与查找紧密相关。查找功能还提供一些不同的特性：
</p>
<p>
<i>简单的查询替换功能</i> <br/>
这个功能就是将全文中的一个字符串用另一个字符串替换。一般情况下，这种方式比较粗鲁可能会导致非预期效果。试试询问替换方式。
</p>
<p>
<i>询问替换</i> <br/>
在询问替换中，Emacs有条件的替换全文中的字符串。Emacs查找全文中出现的字符串，并且每次都询问你是否要执行替换操作。如果你只想改变一
部分而不是全部的话，这种替换比较有用，例如替换单词或者短语。
</p>
<p>
<i>正则表达式替换</i> <br/>
正则表达式替换使用功能强大的字符串模式匹配功能来查找和替换。
</p>
<p>
那么你现在知道要介绍的内容了。不过，不用担心有这么多查询方式可用。事实上，你工作时有99％的情况下使用某种特定的查找和替换指令。例
如，我们大部分时候使用递增查询和替换查询。如果你是位作家，那你可能只使用单词查询功能；如果你是位程序员，那么你或许愿意使用正则表
达式查询，如果你只是刚刚开始使用，那么你或许想学习递增查询和本章中其他一些内容。不论如何，如果你知道了可用的查询功能，你都可以试
一下。
</p>
<p>
<b>3.1.1 递增查询</b>
</p>
<p>
递增查询在你输入要查询的第一个字符时就开始工作了。许多用户喜欢递增查询的高效，而且他们也喜欢高亮显示。Emacs会以水蓝色显示所有查
询到的字符串（如果你的显示器支持的话）并且用紫色显示光标所在位置的字符串（当前匹配项）。
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col align="left" /></colgroup>
<thead>
<tr><th scope="col">Type: C-s m</th></tr>
</thead>
<tbody>
</tbody>
<tbody>
<tr><td><img src="../images/ge3_ch03scrn01.gif"  alt="../images/ge3_ch03scrn01.gif" /></td></tr>
</tbody>
<tbody>
<tr><td>Emacs高亮显示全部以m开头的单词</td></tr>
</tbody>
</table>


<p>
打开递增查询，输入 <b>C-s</b> 并输入你要查询的文本。Emacs临时进入Isearch模式。要注意这种查询是如何工作的：Emacs在你输入字符时马上查询
匹配项。例如，如果你在查询单词 <i>meter</i> ，在递增查询中，Emacs在你输入完 <i>m</i> 后立即查询下一个 <i>m</i> ；在输入完 <i>e</i> 后立即查询 <i>me</i>
；在输入完 <i>t</i> 后立即查询 <i>met</i> ，等等。或早或晚，你会找到你想找的内容，或者Emacs没有找到任何匹配项。如果你找到了想找的内容，按
<b>Enter</b> ；就可以停留到文件中查询到的位置了。如果没有找到任何匹配项，会在窗口的最正文打印消息 <b>Search Failed</b> 并鸣叫。
</p>
<p>
下面显示我们在查询单词 <i>meter</i> 时的情况；数字指示出在要查询的字符串中每个字符输入时，光标是如何移动的。
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col align="left" /></colgroup>
<thead>
<tr><th scope="col">Type: C-s meter</th></tr>
</thead>
<tbody>
</tbody>
<tbody>
<tr><td><img src="../images/ge3_ch03scrn02.gif"  alt="../images/ge3_ch03scrn02.gif" /></td></tr>
</tbody>
<tbody>
<tr><td>在你输入查询字符串的字母时，光标从一个位置移动到另一个位置</td></tr>
</tbody>
</table>


<p>
在这个递增查询字符串 <i>meter</i> 的过程中，Emacs将光标从位置１移动到２，到３，等等。并且，注意 <i>Isearch</i> 在模式行中显示。
</p>
<p>
当你找到了要查询的字符串，不过找到的位置不对，怎么办？如果你找到文件最后一个单词，不过还不是你要找的那个位置。只要再按
<b>C-s</b> 来查找下一个匹配项。Emacs按照相同的字符串查询，而不必重新输入。
</p>
<p>
查到你要找的文本后，记得按 <b>Enter</b> 。忘记停止查询（通过按 <b>Enter</b> 或者其他光标移动指令）是一个常见失误：在你输入的时
候，Emacs突然在不同的地方停止显示。发生的什么？Emacs以为仍然在查询，并将你输入的字符增加到查询字符串上。
</p>
<p>
如果你输入了错误的字符，按 <b>Del</b> : Emacs退回到文件中前一个匹配字符串。如果连续按 <b>Del</b> 删除查询字符串的字符，你会看到
Emacs会依次回退到前一匹配项。
</p>
<p>
取消查询（换言之，退出查询），输入 <b>C-g</b> 。这个指令会带你退回到查询前的位置。
</p>
<p>
在文件中向上查询时，使用 <b>C-r</b> ，它和 <b>C-s</b> 工作方式一样，只不过方向相反。它会将光标移动到查询字符串的首字符处显示。和
<b>C-s</b> 一样，你可以重复按 <b>C-r</b> 查找前一个匹配项，而不必重新输入字符串。
</p>
<p>
要不想输入查询字符串，你可以从缓冲区内复制文本到查询字符串。要复制从光标处到下一个空格或者标点符号的文本到查询字符串时，输入
<b>C-s C-w</b> （可以把 <b>C-s C-w</b> 想成 “search a word”)。要复制从光标处到行尾的文本到查询字符串中，输入 <b>C-s C-y</b> 。值得注意的是，
复制的文本会被轮换成小写格式；这个转换可以让查询大小写不敏感。也可以通过按 <b>C-s M-y</b> 将杀戮环中的内容复制到查询字符串中。在输入
这个指令后，你可以通过按 <b>M-p</b> 查看杀戮环中前一个文本项，按 <b>M-n</b> 查看下一个。
</p>
<p>
在递增查询状态下，一些键（如：回车，删除）会有与平常不同的功能。听起来有些迷糊，实际上相当容易使用。表 3-1 介绍了递增查询情况下
的按键功能
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption>表 3-1. 递增查询指令</caption>
<colgroup><col align="left" /></colgroup><colgroup><col align="left" /></colgroup><colgroup><col align="left" /></colgroup>
<thead>
<tr><th scope="col">快捷键</th><th scope="col">指令名称</th><th scope="col">功能</th></tr>
</thead>
<tbody>
</tbody>
<tbody>
<tr><td><b>C-s</b> Edit-&gt; Search-&gt; Incremental Search-&gt; Forward String</td><td>isearch-forward</td><td>开始向下递增查询，后面输入查询字符串，并且向下查询第一个匹配项。</td></tr>
</tbody>
<tbody>
<tr><td><b>C-r</b> Edit-&gt; Search-&gt; Incremental Search-&gt; Backward String</td><td>isearch-backward</td><td>开始向上递增查询，后面输入查询字符串，并且向上查询第一个匹配项。</td></tr>
</tbody>
<tbody>
<tr><td><b>Enter</b></td><td>isearch-exit</td><td>在递增查询时，结束递增查询。</td></tr>
</tbody>
<tbody>
<tr><td><b>C-g</b></td><td>keyboard-quit</td><td>在递增查询时，取消递增查询。</td></tr>
</tbody>
<tbody>
<tr><td><b>Del</b></td><td>isearch-delete-char</td><td>在递增查询时，删除查询字符串的字符。</td></tr>
</tbody>
<tbody>
<tr><td><b>C-s C-w</b></td><td>isearch-yank-word</td><td>以光标所在字符串为查询字符串执行递增查询。</td></tr>
</tbody>
<tbody>
<tr><td><b>C-s C-y</b></td><td>isearch-yank-line</td><td>以光标所在位置到行尾的文本作为查询字符串执行递增查询。</td></tr>
</tbody>
<tbody>
<tr><td><b>C-s M-y</b></td><td>isearch-yank-kill</td><td>以杀戮环的最近一个文本作为查询字符串执行递增查询。</td></tr>
</tbody>
<tbody>
<tr><td>C-s C-s</td><td>isearch-repeat-forward</td><td>重复执行向下查询。</td></tr>
</tbody>
<tbody>
<tr><td><b>C-r C-r</b></td><td>isearch-repeat-backward</td><td>重复执行向上查询。</td></tr>
</tbody>
</table>


<p>
<b>3.1.2 简单查询</b>
</p>
<p>
Emacs也提供简单的，非递增查询。要使用这种更直接的查询，输入 <b>C-s Enter</b> 。输入查询字符串，按 <b>Enter</b> ，然后Emacs开始查询。只要按
<b>C-s</b> 就可以查询下一个。同样， <b>C-r Enter</b> 可以执行向上查询。
</p>
<p>
工具栏的查询图标（放在纸上的放大镜）和Edit -&gt; Search -&gt;  String Forward选项功能一样。不过提示有一点区别。 <b>C-s Enter</b> 在迷你缓冲
区的的提示为 <i>Search:</i> 而工具栏按钮和菜单选项的提示为 <i>Search for string:</i> 。
</p>
<p>
表3-2总结了简单查询的指令。
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption>简单查询指令</caption>
<colgroup><col align="left" /></colgroup><colgroup><col align="left" /></colgroup>
<thead>
<tr><th scope="col">快捷键</th><th scope="col">功能</th></tr>
</thead>
<tbody>
</tbody>
<tbody>
<tr><td><b>C-s</b> <i>searchstring</i> <b>Enter</b> Edit-&gt; Search-&gt; String Forward</td><td>开始非递增向下查询。</td></tr>
</tbody>
<tbody>
<tr><td>C-s</td><td>重复查询下一个。</td></tr>
</tbody>
<tbody>
<tr><td><b>C-r</b> <i>searchstring</i> <b>Enter</b> Edit-&gt; Search-&gt; String Backwards</td><td>开始非递增向上查询。</td></tr>
</tbody>
<tbody>
<tr><td><b>C-r</b></td><td>重复查询上一个。</td></tr>
</tbody>
</table>



<p>
<b>3.1.3 短语查询</b>
</p>
<p>
如果你要查询一个短语，并且你知道它在文章中，不过用递增查询又找不到，就试试短语查询吧。（很可能由于短语中间有个换行符递增查询就找
不到这个短语了。）短语查询是非递增查询的，并且忽略换行符，空格和标点。它也要求你查询的字符串完全匹配。
</p>
<p>
执行短语查询，输入 <b>C-s Enter C-w</b> (表示 <b>word-search-forward</b> ).提示信息 <i>Word search</i> 显示在迷你缓冲区内。（不要因为提示信息而
终止：按完 <b>C-s</b> 迷你缓冲区会显示 <i>I-search</i> ，按完 <b>Enter</b> 会显示 <i>Search</i> ，不必在意）。输入查询字符串，然后按 <b>Enter</b>
。Emacs查找字符串。要向上查询短语，输入 <b>C-r Enter C-w</b> 。例如，假设你有以下文本，并且光标在开头：
</p>
<p>
<i>He said, "All good elephants are wise, aren't they?</i>" 
</p>
<p>
<i>She answered, "Some are smarter than others, but we</i>
</p>
<p>
<i>think this is socially conditioned.</i>"
</p>
<p>
输入指令 <b>C-s Enter C-w they she Enter</b> ，光标显示在单词 <i>she</i> 的后面。这个指令看着很复杂，但是相对要查询的短语，他们
（C-s Enter C-w)就显得不那么复杂了。它忽略了 <i>they</i> 和　/she/ 标点（？“）和换行符。
</p>
<p>
假设你要查询单词 <i>the</i> 。而不想被 <i>thence</i> , <i>there</i> , <i>theater</i> , <i>thesis</i> , <i>blithe</i> , 或者其他恰巧包含字母组合 <i>the</i>
。这时，递增查询和简单查询就不太适合了－－你应该用词组查询。如果你在写论文，词组查询会比较有用。它是三种基本查询功能中唯
一一种让你能找到词组被分割到两行的查询功能。
</p>
<p>
你已经看了三种最基本的查询功能，实验一下，看看哪种你觉得最有用。
</p><div id="postamble">
<p class="author"> Author: moomu
</p>
<p class="date"> Date: 2010-12-20 23:02:59 CST</p>
<p class="creator">HTML generated by org-mode 6.36c in emacs 23</p>
</div>
</div>
</body>
</html>
